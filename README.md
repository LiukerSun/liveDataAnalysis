# 📊 直播数据分析可视化平台

一个功能强大的多场直播数据分析和可视化平台，提供全面的SKU数据分析、场次对比和趋势分析功能。

## 🌟 主要功能

### 📈 数据分析模式
- **聚合分析**: 汇总所有场次数据，按SKU进行综合分析
- **场次对比**: 查看SKU在不同场次的表现趋势和对比
- **单场分析**: 深入分析单个场次的详细数据

### 🎯 核心特性
- 📊 **交互式可视化**: 基于Plotly的动态图表和数据展示
- 🔍 **灵活筛选**: 支持SKU筛选、价格范围筛选、多维度排序
- 📁 **多源数据支持**: 支持文件夹批量加载或单文件分析
- 💾 **数据导出**: 支持CSV格式的数据和统计报告导出
- 🎨 **用户友好界面**: 基于Streamlit的直观Web界面

### 📋 分析维度
- 💰 **价格分析**: 直播间价格分布、价格对比分析
- 👥 **用户行为**: 商品点击人数、用户参与度分析
- 🎯 **转化分析**: 点击转化率、讲解效率分析
- 📊 **趋势分析**: 多场次SKU表现趋势对比

## 🚀 快速开始

### 环境要求
- Python 3.7+
- 支持的操作系统: Windows, macOS, Linux

### 安装依赖
```bash
pip install -r requirements.txt
```

### 数据准备
1. 将Excel数据文件（.xlsx格式）放置在 `data/` 目录下
2. 确保Excel文件包含以下关键字段：
   - 商品名称
   - 直播间价格
   - 用户支付金额
   - 商品点击人数
   - 成交件数
   - 转化率相关字段

### 启动应用
```bash
streamlit run streamlit_app.py
```

应用将在浏览器中自动打开，默认地址: `http://localhost:8501`

## 📁 项目结构

```
dataAnalysis/
├── data/                   # 数据文件目录
├── logs/                   # 日志文件目录
├── utils/                  # 工具包
│   ├── __init__.py
│   ├── DataLoader.py       # 数据加载和处理类
│   └── CustomLogger.py     # 自定义日志工具
├── streamlit_app.py        # 主应用程序
├── extract_sku.py          # SKU提取工具
├── getSkuName.py          # SKU名称收集工具
├── requirements.txt        # Python依赖
└── README.md              # 项目文档
```

## 🛠️ 辅助工具

### SKU提取工具 (`extract_sku.py`)
从商品标题中提取货号信息，支持多种编码格式：
```bash
python extract_sku.py
```

### SKU名称收集工具 (`getSkuName.py`)
从所有数据文件中收集和整理SKU名称：
```bash
python getSkuName.py
```

## 📊 使用指南

### 1. 数据源配置
- **文件夹模式**: 自动加载指定文件夹中的所有Excel文件
- **单文件模式**: 加载指定的单个Excel文件进行分析

### 2. 分析视图选择

#### 聚合分析
- 查看所有场次的汇总数据
- 支持SKU筛选、价格范围筛选
- 提供多维度排序功能
- 包含价格分析、用户行为、转化分析三个维度

#### 场次对比
- 多场次SKU表现趋势对比
- 支持多种筛选方式：
  - 显示全部
  - 手动选择SKU
  - 按表现排序
  - 限制显示数量
- 动态折线图展示趋势变化

#### 单场分析
- 单个场次的详细数据分析
- 数据概览和详细表格展示
- 关键指标统计

### 3. 数据导出
- CSV格式数据导出
- 统计报告导出
- 支持当前视图数据导出

## 🔧 技术栈

- **Web框架**: Streamlit - 快速构建数据应用
- **数据处理**: Pandas - 强大的数据分析库
- **可视化**: Plotly - 交互式图表库  
- **Excel处理**: OpenPyXL - Excel文件读写
- **日志**: Loguru - 简洁的日志记录
- **编码检测**: Chardet - 自动编码检测

## 📈 数据格式要求

Excel文件应包含以下字段（字段名可能有所变化）：
- `商品名称`: 商品的完整名称
- `直播间价格`: 商品在直播间的售价
- `用户支付金额`: 用户实际支付的金额
- `商品点击人数`: 商品页面的点击人数
- `成交件数`: 实际成交的商品件数
- `商品点击-成交转化率（人数）`: 点击到成交的转化率
- `成交件数/每次讲解`: 讲解效率指标

## 🎨 界面特性

- **响应式布局**: 适配不同屏幕尺寸
- **侧边栏配置**: 便捷的参数设置和筛选控制
- **选项卡设计**: 清晰的功能分类和导航
- **实时反馈**: 交互操作的即时响应
- **数据缓存**: 优化的数据加载性能

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目：

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启Pull Request

## 📄 许可证

本项目基于MIT许可证开源 - 查看 [LICENSE](LICENSE) 文件了解详情

## 🆘 常见问题

### Q: 数据文件格式不正确怎么办？
A: 请确保Excel文件包含必要的字段，并且数据格式正确。可以参考示例数据文件。

### Q: 图表显示异常怎么处理？
A: 检查数据中是否存在空值或异常值，可以尝试数据清洗后重新加载。

### Q: 如何处理中文编码问题？
A: 项目已集成自动编码检测功能，支持常见的中文编码格式。

### Q: 可以分析多少个场次的数据？
A: 理论上没有限制，但建议根据系统性能合理控制数据量。

---

🎯 **让数据分析更简单、更直观、更高效！** 