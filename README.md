# 数据分析可视化看板

这是一个基于Streamlit的数据可视化应用，用于分析和展示您的业务数据。

## 功能特性

### 📊 数据展示
- 交互式数据表格显示
- 实时数据统计概览
- 支持数据筛选和排序

### 🔍 数据筛选
- **SKU筛选**：根据商品SKU进行筛选
- **价格范围筛选**：设置直播间价格范围
- **动态更新**：筛选结果实时更新

### 📈 排序功能
- 支持按任意数值列排序
- 升序/降序排序选项
- 排序结果即时生效

### 📊 数据可视化
- **价格分析**：价格分布图、价格对比散点图
- **用户行为**：点击人数分析、讲解次数与点击关系
- **转化分析**：转化率分布、转化率与支付金额关系
- **综合对比**：多维度商品对比分析

### 💾 数据导出
- 导出筛选后的数据为CSV格式
- 导出数据统计报告
- 支持中文编码

## 安装依赖

在运行应用之前，请先安装所需的依赖包：

```bash
pip install -r requirements.txt
```

## 运行应用

### 方法1：使用streamlit命令行
```bash
streamlit run streamlit_app.py
```

### 方法2：直接运行Python文件
```bash
python streamlit_app.py
```

应用将在浏览器中自动打开，通常地址是：`http://localhost:8501`

## 数据要求

- 确保您的Excel数据文件位于 `data/20250701_y.xlsx`
- 数据文件应包含以下列（部分列名可能不同）：
  - 商品名称
  - 直播间价格
  - 用户支付金额
  - 商品点击人数
  - 讲解次数
  - 商品点击-成交转化率（人数）

## 使用说明

1. **启动应用**：运行上述命令后，应用会自动加载数据
2. **数据筛选**：使用左侧边栏的筛选选项来过滤数据
3. **排序**：在侧边栏选择排序列和排序方向
4. **查看图表**：在不同的选项卡中查看各种可视化图表
5. **导出数据**：使用底部的导出功能保存处理后的数据

## 故障排除

### 数据加载失败
- 检查数据文件是否存在于正确路径
- 确认Excel文件格式正确
- 查看日志文件 `logs/app.log` 获取详细错误信息

### 依赖包问题
```bash
# 升级pip
pip install --upgrade pip

# 重新安装依赖
pip install -r requirements.txt --force-reinstall
```

### 端口占用问题
如果8501端口被占用，可以指定其他端口：
```bash
streamlit run streamlit_app.py --server.port 8502
```

## 技术栈

- **Streamlit**：Web应用框架
- **Pandas**：数据处理
- **Plotly**：交互式图表
- **Loguru**：日志记录
- **OpenPyXL**：Excel文件读取 