# 📊 直播数据分析可视化平台

一个功能强大的多场直播数据分析和可视化平台，提供全面的SKU数据分析、场次对比和趋势分析功能。

## 🌟 主要功能

### 📈 数据分析模式
- **聚合分析**: 汇总所有场次数据，按SKU进行综合分析
- **场次对比**: 查看SKU在不同场次的表现趋势和对比
- **单场分析**: 深入分析单个场次的详细数据

### 🎯 核心特性
- 📊 **交互式可视化**: 基于Plotly和PyEcharts的动态图表和数据展示
- 🔍 **灵活筛选**: 支持SKU筛选、价格范围筛选、多维度排序
- 📁 **多源数据支持**: 支持文件夹批量加载或单文件分析
- 💾 **数据导出**: 支持CSV格式的数据和统计报告导出
- 🎨 **用户友好界面**: 基于Streamlit的直观Web界面
- 🤖 **智能SKU提取**: 使用正则表达式从商品名称中自动提取货号

### 📋 分析维度
- 💰 **价格分析**: 直播间价格分布、价格对比分析
- 👥 **用户行为**: 商品点击人数、用户参与度分析
- 🎯 **转化分析**: 点击转化率、讲解效率分析
- 📊 **趋势分析**: 多场次SKU表现趋势对比（支持智能筛选和排序）

## 🚀 快速开始

### 环境要求
- Python 3.7+
- 支持的操作系统: Windows, macOS, Linux

### 安装依赖
```bash
pip install -r requirements.txt
```

### 数据准备
1. 将Excel数据文件（.xlsx格式）放置在 `data/` 目录下
2. 确保Excel文件包含以下关键字段：
   - 商品名称
   - 直播间价格
   - 用户支付金额
   - 商品点击人数
   - 成交件数
   - 讲解次数
   - 商品点击-成交转化率（人数）

### 启动应用
```bash
streamlit run streamlit_app.py
```

应用将在浏览器中自动打开，默认地址: `http://localhost:8501`

## 📁 项目结构

```
dataAnalysis/
├── data/                   # 数据文件目录
├── logs/                   # 日志文件目录
├── utils/                  # 工具包
│   ├── __init__.py
│   ├── DataLoader.py       # 数据加载和处理类
│   └── CustomLogger.py     # 自定义日志工具
├── streamlit_app.py        # 主应用程序
├── requirements.txt        # Python依赖
└── README.md              # 项目文档
```

## 📊 使用指南

### 1. 数据源配置
- **文件夹模式**: 自动加载指定文件夹中的所有Excel文件
- **单文件模式**: 加载指定的单个Excel文件进行分析

### 2. 分析视图选择

#### 聚合分析
- 查看所有场次的汇总数据
- 支持SKU筛选、价格范围筛选
- 提供多维度排序功能
- 包含价格分析、用户行为、转化分析三个维度
- 支持数据导出和统计报告生成

#### 场次对比
- 多场次SKU表现趋势对比
- 智能筛选方式：
  - **按表现排序**: 根据指标排序显示Top N的SKU
  - **限制数量**: 简单限制显示的SKU数量
  - **手动选择**: 自由选择要显示的SKU
  - **显示全部**: 显示所有SKU（适用于数据量较小时）
- 使用PyEcharts创建的高质量趋势折线图
- 支持图表交互（缩放、图例控制、数据标记）

#### 单场分析
- 单个场次的详细数据分析
- 数据概览和详细表格展示
- 关键指标统计（SKU数量、总支付金额、总点击人数、总成交件数）

### 3. 数据导出
- CSV格式数据导出
- 统计报告导出
- 支持当前视图数据导出

## 🔧 技术栈

- **Web框架**: Streamlit - 快速构建数据应用
- **数据处理**: Pandas - 强大的数据分析库
- **可视化**: 
  - Plotly - 交互式图表库（散点图、直方图、柱状图）
  - PyEcharts - 中文友好的图表库（趋势折线图）
- **Excel处理**: OpenPyXL - Excel文件读写
- **日志**: Loguru - 简洁的日志记录

## 🤖 SKU提取算法

项目使用智能正则表达式算法从商品名称中提取SKU货号，支持多种格式：

- `美区[前缀]-货号` 格式
- `【款号XXX琪】` 格式
- 多层级格式：`美区大牌奢品-描述-描述-货号`
- `【TX】货号` 格式
- 纯货号格式（如DC007）

内置黑名单机制，过滤不规范的商品数据。

## 📈 数据格式要求

Excel文件应包含以下字段：
- `商品名称`: 商品的完整名称（用于SKU提取）
- `直播间价格`: 商品在直播间的售价（支持¥符号格式）
- `用户支付金额`: 用户实际支付的金额（支持¥符号格式）
- `商品点击人数`: 商品页面的点击人数
- `成交件数`: 实际成交的商品件数
- `讲解次数`: 商品被讲解的次数
- `商品点击-成交转化率（人数）`: 点击到成交的转化率（支持%格式）
- `首次上架时间`: 商品首次上架时间（可选）

### 自动计算字段
系统会自动计算以下衍生指标：
- `成交件数/每次讲解`: 讲解效率指标
- `单次讲解成交金额`: 每次讲解产生的成交金额

## 🎨 界面特性

- **响应式布局**: 适配不同屏幕尺寸
- **侧边栏配置**: 便捷的参数设置和筛选控制
- **选项卡设计**: 清晰的功能分类和导航
- **实时反馈**: 交互操作的即时响应
- **数据缓存**: 基于Streamlit的优化数据加载性能
- **智能筛选**: 根据数据量自动推荐最佳显示方式

## 🔍 高级功能

### 智能图表筛选
- **动态数量调整**: 根据SKU总数智能推荐显示数量
- **表现排序**: 支持按多种指标排序筛选
- **视觉优化**: 超过15个SKU时自动提示优化显示
- **交互提示**: 根据当前显示数量提供使用建议

### 数据处理优化
- **自动数据清理**: 移除不必要的列，标准化数据格式
- **灵活数据加载**: 支持文件夹批量加载、单文件加载
- **错误处理**: 完善的异常处理和日志记录
- **数据验证**: 自动检测和处理数据格式问题
